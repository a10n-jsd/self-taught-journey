<!DOCTYPE html>
<html>
  <head>
    <title>Exercise: 12i (revisited)</title>
  </head>
  <body>
    <button class="js-add-button">Add</button>

    <button class="js-remove-button">Remove</button>
        
    <script>
      let numOfMessage = 2;
      let intervalID;
      let isDisplayingNotification = false;

      document.querySelector('.js-add-button')
        .addEventListener('click', () => {
          numOfMessage++;
          displayNotification();
      });

      document.querySelector('.js-remove-button')
        .addEventListener('click', () => {
          if (numOfMessage > 0) {
            numOfMessage--;
          }

          // If there are no new message, stop displaying
          // the notification in the tab
          if (numOfMessage === 0) {
            stopNotification();
          }
      })

      // Start displaying the notification in the tab
      // when the page first loads.
      displayNotification();

      function displayNotification() {

        if (!isDisplayingNotification) {
          intervalID = setInterval(() => {

            if (document.title === 'App') {
              document.title = `(${numOfMessage}) New message`;  
            } else {
              document.title = 'App';
            }
          }, 1000);
        }

        isDisplayingNotification = true;
      }

      function stopNotification() {
        clearInterval(intervalID);
        document.title = 'App';
        
        isDisplayingNotification = false;
      }
      
    </script>
  </body>
</html>